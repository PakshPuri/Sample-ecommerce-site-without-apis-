<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gift Haven</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    * {
      font-family: 'Quicksand', sans-serif;
    }
    .page { display: none; }
    .page.active { display: block; }
    .chat-container {
      height: 320px;
      overflow-y: auto;
    }
    .chat-container::-webkit-scrollbar {
      width: 4px;
    }
    .chat-container::-webkit-scrollbar-thumb {
      background: #d1d5db;
      border-radius: 2px;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-rose-50">
  <div id="app" class="h-full w-full overflow-auto"><!-- Header -->
   <header class="bg-white border-b border-rose-200 sticky top-0 z-50">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
     <div class="flex items-center gap-2 cursor-pointer" onclick="navigateTo('home')"><span class="text-2xl">üéÅ</span>
      <h1 id="store-name" class="text-xl font-bold text-rose-700">Gift Haven</h1>
     </div>
     <nav class="flex items-center gap-6"><button onclick="navigateTo('home')" class="text-gray-600 hover:text-rose-600 font-medium transition-colors">Shop</button> <button onclick="navigateTo('cart')" class="flex items-center gap-2 bg-rose-100 px-4 py-2 text-rose-700 font-medium hover:bg-rose-200 transition-colors"> <span>üõí</span> <span>Your Cart</span> <span id="cart-count" class="bg-rose-500 text-white text-xs px-2 py-0.5 font-bold">0</span> </button>
     </nav>
    </div>
   </header><!-- Home Page -->
   <div id="page-home" class="page active"><!-- Hero Section -->
    <section class="bg-gradient-to-b from-rose-100 to-rose-50 py-16">
     <div class="max-w-6xl mx-auto px-4 text-center">
      <h2 id="hero-title" class="text-4xl font-bold text-gray-800 mb-4">Find the Perfect Gift</h2>
      <p id="hero-subtitle" class="text-lg text-gray-600 mb-8">Curated collection of thoughtful presents for every occasion</p>
      <div class="flex justify-center gap-4 flex-wrap"><button onclick="filterCategory('all')" class="category-btn active bg-rose-500 text-white px-6 py-2 font-medium transition-colors" data-category="all">All Gifts</button> <button onclick="filterCategory('birthday')" class="category-btn bg-white text-gray-700 px-6 py-2 font-medium hover:bg-rose-100 transition-colors" data-category="birthday">üéÇ Birthday</button> <button onclick="filterCategory('wedding')" class="category-btn bg-white text-gray-700 px-6 py-2 font-medium hover:bg-rose-100 transition-colors" data-category="wedding">üíí Wedding</button> <button onclick="filterCategory('baby')" class="category-btn bg-white text-gray-700 px-6 py-2 font-medium hover:bg-rose-100 transition-colors" data-category="baby">üë∂ Baby</button> <button onclick="filterCategory('home')" class="category-btn bg-white text-gray-700 px-6 py-2 font-medium hover:bg-rose-100 transition-colors" data-category="home">üè† Home</button> <button onclick="filterCategory('wellness')" class="category-btn bg-white text-gray-700 px-6 py-2 font-medium hover:bg-rose-100 transition-colors" data-category="wellness">üßò Wellness</button>
      </div>
     </div>
    </section><!-- Products Grid -->
    <section class="py-12">
     <div class="max-w-6xl mx-auto px-4">
      <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"><!-- Products will be rendered here -->
      </div>
     </div>
    </section>
   </div><!-- Cart Page -->
   <div id="page-cart" class="page">
    <div class="max-w-4xl mx-auto px-4 py-12">
     <h2 class="text-3xl font-bold text-gray-800 mb-8">üõí Your Cart</h2>
     <div id="cart-empty" class="text-center py-16 hidden"><span class="text-6xl mb-4 block">üõí</span>
      <p class="text-gray-500 text-lg mb-6">Your cart is empty</p><button onclick="navigateTo('home')" class="bg-rose-500 text-white px-8 py-3 font-medium hover:bg-rose-600 transition-colors">Continue Shopping</button>
     </div>
     <div id="cart-content">
      <div class="bg-white border border-rose-200 mb-6">
       <div class="border-b border-rose-100 px-6 py-3 bg-rose-50">
        <div class="grid grid-cols-12 gap-4 text-sm font-semibold text-gray-600">
         <div class="col-span-6">
          Product
         </div>
         <div class="col-span-2 text-center">
          Price
         </div>
         <div class="col-span-2 text-center">
          Quantity
         </div>
         <div class="col-span-2 text-right">
          Subtotal
         </div>
        </div>
       </div>
       <div id="cart-items"><!-- Cart items will be rendered here -->
       </div>
      </div>
      <div class="bg-white border border-rose-200 p-6">
       <div class="flex justify-between items-center mb-4"><span class="text-gray-600">Subtotal</span> <span id="cart-subtotal" class="font-medium">$0.00</span>
       </div>
       <div class="flex justify-between items-center mb-4"><span class="text-gray-600">Shipping</span> <span class="font-medium text-green-600">Free</span>
       </div>
       <div class="border-t border-rose-200 pt-4 flex justify-between items-center"><span class="text-xl font-bold text-gray-800">Total</span> <span id="cart-total" class="text-2xl font-bold text-rose-600">$0.00</span>
       </div><button onclick="navigateTo('checkout')" class="w-full mt-6 bg-rose-500 text-white py-4 font-semibold text-lg hover:bg-rose-600 transition-colors">Proceed to Checkout</button> <button onclick="navigateTo('home')" class="w-full mt-3 bg-white border border-rose-300 text-rose-600 py-3 font-medium hover:bg-rose-50 transition-colors">Continue Shopping</button>
      </div>
     </div>
    </div>
   </div><!-- Checkout Page -->
   <div id="page-checkout" class="page">
    <div class="max-w-4xl mx-auto px-4 py-12">
     <h2 class="text-3xl font-bold text-gray-800 mb-8">üì¶ Checkout</h2>
     <div class="grid lg:grid-cols-3 gap-8">
      <div class="lg:col-span-2">
       <form id="checkout-form" class="space-y-6"><!-- Contact Information -->
        <div class="bg-white border border-rose-200 p-6">
         <h3 class="text-lg font-bold text-gray-800 mb-4">Contact Information</h3>
         <div class="grid sm:grid-cols-2 gap-4">
          <div><label for="firstName" class="block text-sm font-medium text-gray-700 mb-1">First Name</label> <input type="text" id="firstName" required class="w-full border border-gray-300 px-4 py-3 focus:outline-none focus:border-rose-400">
          </div>
          <div><label for="lastName" class="block text-sm font-medium text-gray-700 mb-1">Last Name</label> <input type="text" id="lastName" required class="w-full border border-gray-300 px-4 py-3 focus:outline-none focus:border-rose-400">
          </div>
          <div class="sm:col-span-2"><label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label> <input type="email" id="email" required class="w-full border border-gray-300 px-4 py-3 focus:outline-none focus:border-rose-400">
          </div>
          <div class="sm:col-span-2"><label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Phone</label> <input type="tel" id="phone" required class="w-full border border-gray-300 px-4 py-3 focus:outline-none focus:border-rose-400">
          </div>
         </div>
        </div><!-- Shipping Address -->
        <div class="bg-white border border-rose-200 p-6">
         <h3 class="text-lg font-bold text-gray-800 mb-4">Shipping Address</h3>
         <div class="space-y-4">
          <div><label for="address" class="block text-sm font-medium text-gray-700 mb-1">Street Address</label> <input type="text" id="address" required class="w-full border border-gray-300 px-4 py-3 focus:outline-none focus:border-rose-400">
          </div>
          <div><label for="apartment" class="block text-sm font-medium text-gray-700 mb-1">Apartment, suite, etc. (optional)</label> <input type="text" id="apartment" class="w-full border border-gray-300 px-4 py-3 focus:outline-none focus:border-rose-400">
          </div>
          <div class="grid sm:grid-cols-3 gap-4">
           <div><label for="city" class="block text-sm font-medium text-gray-700 mb-1">City</label> <input type="text" id="city" required class="w-full border border-gray-300 px-4 py-3 focus:outline-none focus:border-rose-400">
           </div>
           <div><label for="state" class="block text-sm font-medium text-gray-700 mb-1">State</label> <input type="text" id="state" required class="w-full border border-gray-300 px-4 py-3 focus:outline-none focus:border-rose-400">
           </div>
           <div><label for="zip" class="block text-sm font-medium text-gray-700 mb-1">ZIP Code</label> <input type="text" id="zip" required class="w-full border border-gray-300 px-4 py-3 focus:outline-none focus:border-rose-400">
           </div>
          </div>
          <div><label for="country" class="block text-sm font-medium text-gray-700 mb-1">Country</label> <select id="country" required class="w-full border border-gray-300 px-4 py-3 focus:outline-none focus:border-rose-400 bg-white"> <option value="">Select country</option> <option value="US">United States</option> <option value="CA">Canada</option> <option value="UK">United Kingdom</option> <option value="AU">Australia</option> <option value="DE">Germany</option> <option value="FR">France</option> </select>
          </div>
         </div>
        </div><button type="submit" class="w-full bg-rose-500 text-white py-4 font-semibold text-lg hover:bg-rose-600 transition-colors">Place Order</button>
       </form>
      </div><!-- Order Summary -->
      <div class="lg:col-span-1">
       <div class="bg-white border border-rose-200 p-6 sticky top-24">
        <h3 class="text-lg font-bold text-gray-800 mb-4">Order Summary</h3>
        <div id="checkout-items" class="space-y-3 mb-4 max-h-64 overflow-y-auto"><!-- Items will be rendered here -->
        </div>
        <div class="border-t border-rose-200 pt-4 space-y-2">
         <div class="flex justify-between text-gray-600"><span>Subtotal</span> <span id="checkout-subtotal">$0.00</span>
         </div>
         <div class="flex justify-between text-gray-600"><span>Shipping</span> <span class="text-green-600">Free</span>
         </div>
         <div class="flex justify-between text-xl font-bold text-gray-800 pt-2 border-t border-rose-200"><span>Total</span> <span id="checkout-total" class="text-rose-600">$0.00</span>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Order Confirmation Page -->
   <div id="page-confirmation" class="page">
    <div class="max-w-2xl mx-auto px-4 py-16 text-center">
     <div class="bg-white border border-rose-200 p-12"><span class="text-6xl mb-6 block">‚úÖ</span>
      <h2 class="text-3xl font-bold text-gray-800 mb-4">Order Confirmed!</h2>
      <p class="text-gray-600 mb-2">Thank you for your purchase.</p>
      <p class="text-gray-600 mb-8">Order #<span id="order-number" class="font-medium">GH-000000</span></p>
      <p class="text-sm text-gray-500 mb-8">A confirmation email has been sent to your email address.</p><button onclick="navigateTo('home'); cart = []; updateCartUI();" class="bg-rose-500 text-white px-8 py-3 font-medium hover:bg-rose-600 transition-colors">Continue Shopping</button>
     </div>
    </div>
   </div><!-- Gift Assistant Chatbot -->
   <div id="chatbot" class="fixed bottom-6 right-6 z-50"><button id="chat-toggle" onclick="toggleChat()" class="bg-rose-500 text-white w-14 h-14 flex items-center justify-center text-2xl hover:bg-rose-600 transition-colors"> üí¨ </button>
    <div id="chat-window" class="hidden absolute bottom-16 right-0 w-80 bg-white border border-rose-200 overflow-hidden">
     <div class="bg-rose-500 text-white p-4">
      <div class="flex items-center gap-3"><span class="text-2xl">üéÅ</span>
       <div>
        <h4 class="font-bold">Gift Assistant</h4>
        <p class="text-xs text-rose-100">Here to help you find the perfect gift</p>
       </div>
      </div>
     </div>
     <div id="chat-messages" class="chat-container p-4 bg-rose-50">
      <div class="mb-3">
       <div class="bg-white p-3 border border-rose-100 text-sm text-gray-700">
        Hi! üëã I'm your gift assistant. Tell me who you're shopping for and I'll recommend something special!
       </div>
      </div>
     </div>
     <div class="p-3 border-t border-rose-200 bg-white">
      <div class="flex gap-2"><input type="text" id="chat-input" placeholder="Type your message..." class="flex-1 border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:border-rose-400" onkeypress="if(event.key==='Enter')sendMessage()"> <button onclick="sendMessage()" class="bg-rose-500 text-white px-4 py-2 hover:bg-rose-600 transition-colors"> ‚û§ </button>
      </div>
      <div class="flex gap-2 mt-2 flex-wrap"><button onclick="quickQuestion('birthday gift')" class="text-xs bg-rose-100 text-rose-700 px-2 py-1 hover:bg-rose-200">Birthday</button> <button onclick="quickQuestion('wedding gift')" class="text-xs bg-rose-100 text-rose-700 px-2 py-1 hover:bg-rose-200">Wedding</button> <button onclick="quickQuestion('baby shower')" class="text-xs bg-rose-100 text-rose-700 px-2 py-1 hover:bg-rose-200">Baby</button> <button onclick="quickQuestion('under $50')" class="text-xs bg-rose-100 text-rose-700 px-2 py-1 hover:bg-rose-200">Under $50</button>
      </div>
     </div>
    </div>
   </div><!-- Toast Notification -->
   <div id="toast" class="fixed bottom-6 left-6 bg-gray-800 text-white px-6 py-3 opacity-0 pointer-events-none transition-opacity z-50"><span id="toast-message"></span>
   </div>
  </div>
  <script>
    // Default Configuration
    const defaultConfig = {
      store_name: 'Gift Haven',
      hero_title: 'Find the Perfect Gift',
      hero_subtitle: 'Curated collection of thoughtful presents for every occasion',
      background_color: '#fff1f2',
      surface_color: '#ffffff',
      text_color: '#1f2937',
      primary_color: '#f43f5e',
      secondary_color: '#fecdd3'
    };

    // Products Data
    const products = [
      { id: 1, name: 'Luxury Candle Set', price: 45.00, category: 'home', emoji: 'üïØÔ∏è', stock: 8, description: 'Hand-poured soy candles in elegant glass jars' },
      { id: 2, name: 'Personalized Photo Frame', price: 35.00, category: 'birthday', emoji: 'üñºÔ∏è', stock: 15, description: 'Custom engraved wooden frame' },
      { id: 3, name: 'Spa Gift Basket', price: 89.00, category: 'wellness', emoji: 'üß¥', stock: 5, description: 'Complete relaxation kit with bath bombs' },
      { id: 4, name: 'Gourmet Chocolate Box', price: 55.00, category: 'birthday', emoji: 'üç´', stock: 20, description: 'Artisan truffles assortment' },
      { id: 5, name: 'Crystal Wine Glasses', price: 75.00, category: 'wedding', emoji: 'ü•Ç', stock: 12, description: 'Set of 4 hand-blown glasses' },
      { id: 6, name: 'Baby Memory Book', price: 42.00, category: 'baby', emoji: 'üìî', stock: 10, description: 'Beautiful keepsake journal' },
      { id: 7, name: 'Cashmere Throw Blanket', price: 120.00, category: 'home', emoji: 'üõãÔ∏è', stock: 6, description: 'Ultra-soft premium blanket' },
      { id: 8, name: 'Aromatherapy Diffuser', price: 65.00, category: 'wellness', emoji: 'üå∏', stock: 18, description: 'Ceramic diffuser with oils' },
      { id: 9, name: 'Mr & Mrs Mug Set', price: 28.00, category: 'wedding', emoji: '‚òï', stock: 25, description: 'Matching ceramic couple mugs' },
      { id: 10, name: 'Plush Teddy Bear', price: 32.00, category: 'baby', emoji: 'üß∏', stock: 30, description: 'Super soft cuddly companion' },
      { id: 11, name: 'Leather Journal', price: 48.00, category: 'birthday', emoji: 'üìì', stock: 14, description: 'Hand-stitched genuine leather' },
      { id: 12, name: 'Succulent Garden Kit', price: 38.00, category: 'home', emoji: 'ü™¥', stock: 9, description: 'DIY mini garden with 3 plants' },
      { id: 13, name: 'Silk Pajama Set', price: 95.00, category: 'wellness', emoji: 'üëò', stock: 7, description: 'Luxurious sleepwear' },
      { id: 14, name: 'Engraved Cutting Board', price: 58.00, category: 'wedding', emoji: 'ü™µ', stock: 11, description: 'Personalized wooden board' },
      { id: 15, name: 'Baby Mobile', price: 52.00, category: 'baby', emoji: 'üåô', stock: 8, description: 'Hand-crafted felt mobile' },
      { id: 16, name: 'Vintage Watch Box', price: 68.00, category: 'birthday', emoji: '‚åö', stock: 6, description: 'Elegant storage for timepieces' }
    ];

    // Cart State
    let cart = [];
    let currentCategory = 'all';

    // Navigation
    function navigateTo(page) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(`page-${page}`).classList.add('active');
      window.scrollTo(0, 0);
      
      if (page === 'cart') renderCart();
      if (page === 'checkout') renderCheckoutSummary();
    }

    // Category Filter
    function filterCategory(category) {
      currentCategory = category;
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.classList.remove('active', 'bg-rose-500', 'text-white');
        btn.classList.add('bg-white', 'text-gray-700');
      });
      const activeBtn = document.querySelector(`[data-category="${category}"]`);
      activeBtn.classList.add('active', 'bg-rose-500', 'text-white');
      activeBtn.classList.remove('bg-white', 'text-gray-700');
      renderProducts();
    }

    // Render Products
    function renderProducts() {
      const grid = document.getElementById('products-grid');
      const filtered = currentCategory === 'all' 
        ? products 
        : products.filter(p => p.category === currentCategory);
      
      grid.innerHTML = filtered.map(product => `
        <div class="bg-white border border-rose-200 overflow-hidden group">
          <div class="aspect-square bg-rose-50 flex items-center justify-center text-7xl">
            ${product.emoji}
          </div>
          <div class="p-4">
            <span class="text-xs text-rose-500 font-medium uppercase tracking-wide">${product.category}</span>
            <h3 class="font-bold text-gray-800 mt-1 mb-1">${product.name}</h3>
            <p class="text-sm text-gray-500 mb-3">${product.description}</p>
            <div class="flex items-center justify-between">
              <span class="text-xl font-bold text-rose-600">$${product.price.toFixed(2)}</span>
              <button onclick="addToCart(${product.id})" class="bg-rose-500 text-white px-4 py-2 text-sm font-medium hover:bg-rose-600 transition-colors flex items-center gap-2">
                <span>üõí</span> Add to Cart
              </button>
            </div>
            ${product.stock <= 5 ? `<p class="text-xs text-orange-600 mt-2">Only ${product.stock} left!</p>` : ''}
          </div>
        </div>
      `).join('');
    }

    // Add to Cart
    function addToCart(productId) {
      const product = products.find(p => p.id === productId);
      const existingItem = cart.find(item => item.id === productId);
      
      if (existingItem) {
        if (existingItem.quantity >= product.stock) {
          showToast(`Sorry, only ${product.stock} available in stock`);
          return;
        }
        existingItem.quantity++;
      } else {
        cart.push({ ...product, quantity: 1 });
      }
      
      updateCartUI();
      showToast(`${product.name} added to cart! üéâ`);
    }

    // Update Cart Quantity
    function updateQuantity(productId, change) {
      const item = cart.find(i => i.id === productId);
      const product = products.find(p => p.id === productId);
      
      if (item) {
        const newQuantity = item.quantity + change;
        
        if (newQuantity < 1) {
          cart = cart.filter(i => i.id !== productId);
        } else if (newQuantity > product.stock) {
          showToast(`Out of stock! Maximum ${product.stock} available`);
          return;
        } else {
          item.quantity = newQuantity;
        }
        
        updateCartUI();
        renderCart();
      }
    }

    // Render Cart
    function renderCart() {
      const itemsContainer = document.getElementById('cart-items');
      const emptyState = document.getElementById('cart-empty');
      const content = document.getElementById('cart-content');
      
      if (cart.length === 0) {
        emptyState.classList.remove('hidden');
        content.classList.add('hidden');
        return;
      }
      
      emptyState.classList.add('hidden');
      content.classList.remove('hidden');
      
      itemsContainer.innerHTML = cart.map(item => {
        const product = products.find(p => p.id === item.id);
        return `
          <div class="grid grid-cols-12 gap-4 items-center px-6 py-4 border-b border-rose-100" data-cart-item="${item.id}">
            <div class="col-span-6 flex items-center gap-4">
              <span class="text-3xl">${item.emoji}</span>
              <div>
                <h4 class="font-medium text-gray-800">${item.name}</h4>
                <p class="text-sm text-gray-500">${item.category}</p>
              </div>
            </div>
            <div class="col-span-2 text-center text-gray-700">$${item.price.toFixed(2)}</div>
            <div class="col-span-2 flex items-center justify-center gap-2">
              <button onclick="updateQuantity(${item.id}, -1)" class="w-8 h-8 bg-rose-100 text-rose-700 font-bold hover:bg-rose-200 transition-colors">‚àí</button>
              <span class="w-8 text-center font-medium">${item.quantity}</span>
              <button onclick="updateQuantity(${item.id}, 1)" class="w-8 h-8 bg-rose-100 text-rose-700 font-bold hover:bg-rose-200 transition-colors ${item.quantity >= product.stock ? 'opacity-50 cursor-not-allowed' : ''}">+</button>
            </div>
            <div class="col-span-2 text-right font-bold text-gray-800">$${(item.price * item.quantity).toFixed(2)}</div>
          </div>
        `;
      }).join('');
      
      updateTotals();
    }

    // Update Totals
    function updateTotals() {
      const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      
      document.getElementById('cart-subtotal').textContent = `$${total.toFixed(2)}`;
      document.getElementById('cart-total').textContent = `$${total.toFixed(2)}`;
    }

    // Render Checkout Summary
    function renderCheckoutSummary() {
      const container = document.getElementById('checkout-items');
      const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      
      container.innerHTML = cart.map(item => `
        <div class="flex justify-between items-center text-sm">
          <div class="flex items-center gap-2">
            <span>${item.emoji}</span>
            <span class="text-gray-700">${item.name}</span>
            <span class="text-gray-400">√ó${item.quantity}</span>
          </div>
          <span class="font-medium">$${(item.price * item.quantity).toFixed(2)}</span>
        </div>
      `).join('');
      
      document.getElementById('checkout-subtotal').textContent = `$${total.toFixed(2)}`;
      document.getElementById('checkout-total').textContent = `$${total.toFixed(2)}`;
    }

    // Update Cart UI
    function updateCartUI() {
      const count = cart.reduce((sum, item) => sum + item.quantity, 0);
      document.getElementById('cart-count').textContent = count;
    }

    // Toast Notification
    function showToast(message) {
      const toast = document.getElementById('toast');
      document.getElementById('toast-message').textContent = message;
      toast.classList.remove('opacity-0', 'pointer-events-none');
      toast.classList.add('opacity-100');
      
      setTimeout(() => {
        toast.classList.add('opacity-0', 'pointer-events-none');
        toast.classList.remove('opacity-100');
      }, 3000);
    }

    // Checkout Form
    document.getElementById('checkout-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const orderNum = 'GH-' + Math.random().toString(36).substr(2, 6).toUpperCase();
      document.getElementById('order-number').textContent = orderNum;
      navigateTo('confirmation');
    });

    // Chatbot Functions
    function toggleChat() {
      const window = document.getElementById('chat-window');
      window.classList.toggle('hidden');
    }

    function quickQuestion(topic) {
      document.getElementById('chat-input').value = `I'm looking for a ${topic}`;
      sendMessage();
    }

    function sendMessage() {
      const input = document.getElementById('chat-input');
      const message = input.value.trim();
      if (!message) return;
      
      const messagesContainer = document.getElementById('chat-messages');
      
      // Add user message
      messagesContainer.innerHTML += `
        <div class="mb-3 text-right">
          <div class="inline-block bg-rose-500 text-white p-3 text-sm max-w-xs">
            ${message}
          </div>
        </div>
      `;
      
      input.value = '';
      
      // Generate response
      setTimeout(() => {
        const response = generateResponse(message.toLowerCase());
        messagesContainer.innerHTML += `
          <div class="mb-3">
            <div class="bg-white p-3 border border-rose-100 text-sm text-gray-700">
              ${response}
            </div>
          </div>
        `;
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
      }, 800);
      
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    function generateResponse(message) {
      const recommendations = [];
      
      // Birthday gifts
      if (message.includes('birthday') || message.includes('bday')) {
        recommendations.push(
          products.find(p => p.name === 'Personalized Photo Frame'),
          products.find(p => p.name === 'Gourmet Chocolate Box'),
          products.find(p => p.name === 'Leather Journal')
        );
        return formatRecommendation('birthday gift', recommendations);
      }
      
      // Wedding gifts
      if (message.includes('wedding') || message.includes('couple') || message.includes('married')) {
        recommendations.push(
          products.find(p => p.name === 'Crystal Wine Glasses'),
          products.find(p => p.name === 'Mr & Mrs Mug Set'),
          products.find(p => p.name === 'Engraved Cutting Board')
        );
        return formatRecommendation('wedding', recommendations);
      }
      
      // Baby gifts
      if (message.includes('baby') || message.includes('newborn') || message.includes('shower')) {
        recommendations.push(
          products.find(p => p.name === 'Baby Memory Book'),
          products.find(p => p.name === 'Plush Teddy Bear'),
          products.find(p => p.name === 'Baby Mobile')
        );
        return formatRecommendation('new baby', recommendations);
      }
      
      // Home gifts
      if (message.includes('home') || message.includes('house') || message.includes('housewarming')) {
        recommendations.push(
          products.find(p => p.name === 'Luxury Candle Set'),
          products.find(p => p.name === 'Cashmere Throw Blanket'),
          products.find(p => p.name === 'Succulent Garden Kit')
        );
        return formatRecommendation('home', recommendations);
      }
      
      // Wellness/relaxation
      if (message.includes('relax') || message.includes('spa') || message.includes('wellness') || message.includes('stress')) {
        recommendations.push(
          products.find(p => p.name === 'Spa Gift Basket'),
          products.find(p => p.name === 'Aromatherapy Diffuser'),
          products.find(p => p.name === 'Silk Pajama Set')
        );
        return formatRecommendation('relaxation', recommendations);
      }
      
      // Budget-conscious
      if (message.includes('under $50') || message.includes('cheap') || message.includes('budget') || message.includes('affordable')) {
        const budgetItems = products.filter(p => p.price < 50).slice(0, 3);
        return formatRecommendation('budget-friendly', budgetItems);
      }
      
      // Luxury/premium
      if (message.includes('luxury') || message.includes('premium') || message.includes('expensive') || message.includes('special')) {
        const luxuryItems = products.filter(p => p.price >= 75).slice(0, 3);
        return formatRecommendation('premium', luxuryItems);
      }
      
      // Mom
      if (message.includes('mom') || message.includes('mother') || message.includes('mum')) {
        recommendations.push(
          products.find(p => p.name === 'Spa Gift Basket'),
          products.find(p => p.name === 'Luxury Candle Set'),
          products.find(p => p.name === 'Cashmere Throw Blanket')
        );
        return formatRecommendation('mom', recommendations);
      }
      
      // Dad
      if (message.includes('dad') || message.includes('father')) {
        recommendations.push(
          products.find(p => p.name === 'Leather Journal'),
          products.find(p => p.name === 'Vintage Watch Box'),
          products.find(p => p.name === 'Engraved Cutting Board')
        );
        return formatRecommendation('dad', recommendations);
      }
      
      // Default response
      return `Great question! ü§î To help you find the perfect gift, could you tell me:
        <br><br>‚Ä¢ Who is the gift for? (mom, friend, couple)
        <br>‚Ä¢ What's the occasion? (birthday, wedding, baby shower)
        <br>‚Ä¢ Any budget in mind?`;
    }

    function formatRecommendation(occasion, items) {
      const validItems = items.filter(Boolean);
      const itemsList = validItems.map(item => 
        `<br>‚Ä¢ ${item.emoji} <strong>${item.name}</strong> - $${item.price.toFixed(2)}`
      ).join('');
      
      return `Perfect ${occasion} picks! Here are my top recommendations:
        ${itemsList}
        <br><br>Would you like me to suggest something else? üéÅ`;
    }

    // Element SDK Integration
    async function initializeApp() {
      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            document.getElementById('store-name').textContent = config.store_name || defaultConfig.store_name;
            document.getElementById('hero-title').textContent = config.hero_title || defaultConfig.hero_title;
            document.getElementById('hero-subtitle').textContent = config.hero_subtitle || defaultConfig.hero_subtitle;
            
            const bgColor = config.background_color || defaultConfig.background_color;
            const surfaceColor = config.surface_color || defaultConfig.surface_color;
            const textColor = config.text_color || defaultConfig.text_color;
            const primaryColor = config.primary_color || defaultConfig.primary_color;
            const secondaryColor = config.secondary_color || defaultConfig.secondary_color;
            
            document.body.style.backgroundColor = bgColor;
            document.querySelectorAll('h1, h2, h3, h4').forEach(el => el.style.color = textColor);
          },
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (value) => { config.background_color = value; window.elementSdk.setConfig({ background_color: value }); }
              },
              {
                get: () => config.surface_color || defaultConfig.surface_color,
                set: (value) => { config.surface_color = value; window.elementSdk.setConfig({ surface_color: value }); }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => { config.text_color = value; window.elementSdk.setConfig({ text_color: value }); }
              },
              {
                get: () => config.primary_color || defaultConfig.primary_color,
                set: (value) => { config.primary_color = value; window.elementSdk.setConfig({ primary_color: value }); }
              },
              {
                get: () => config.secondary_color || defaultConfig.secondary_color,
                set: (value) => { config.secondary_color = value; window.elementSdk.setConfig({ secondary_color: value }); }
              }
            ],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (config) => new Map([
            ['store_name', config.store_name || defaultConfig.store_name],
            ['hero_title', config.hero_title || defaultConfig.hero_title],
            ['hero_subtitle', config.hero_subtitle || defaultConfig.hero_subtitle]
          ])
        });
      }
      
      renderProducts();
    }

    initializeApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9bf600ac02901f68',t:'MTc2ODY1NDQ4Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
